import{p as w,q as E,r as d,j as e}from"./index-CuM1UVNz.js";import{u as k,f as C,g as F,a as R,b as V}from"./index-CzaDYwyb.js";import{B as c}from"./button-DvvEsyKI.js";import{T as M,a as B,b as N,c as I,d as H,e as q}from"./table-B6Cf0HfV.js";import{D as z,a as K,b as L,c as A,d as $,e as _}from"./dialog-DY3vMJng.js";import{c as G,d as O,S as P}from"./especialidadService-BF-SVRhy.js";import{A as S}from"./arrow-up-down-Bkh7oTm8.js";import{S as U}from"./square-pen-cdigAb40.js";import{T as W}from"./trash-2-BwIRBH_r.js";import{u as J,P as Q,F as X,S as Y}from"./SearchInput-CDkOK910.js";import{C as Z,c as ee}from"./card-D4d4qW_8.js";import{P as se}from"./plus-6cwyY5hA.js";import{F as ae}from"./funnel-DTkdRWcb.js";import"./Combination-CQ9AiL49.js";import"./axios-CTonWHPK.js";import"./input-ZDudQbKj.js";function ie({filters:x={},onDelete:m}){var v;const o=w(),{toast:p}=E(),[t,l]=d.useState(null),[u,g]=d.useState([]),{data:i,isLoading:h,isError:j,error:r,refetch:D}=G(x),f=O({onSuccess:s=>{p({title:"Especialidad eliminada",description:"La especialidad se ha eliminado correctamente."}),m&&m(s),D()},onError:s=>{p({title:"Error al eliminar",description:`No se pudo eliminar la especialidad: ${s.message}`,variant:"destructive"})}}),y=[{accessorKey:"code",header:({column:s})=>e.jsxs(c,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Código",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("code")})},{accessorKey:"nombre",header:({column:s})=>e.jsxs(c,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:s.getValue("nombre")})]})},{accessorKey:"created_at",header:"Fecha de Creación",cell:({row:s})=>{const a=new Date(s.original.created_at);return e.jsx("div",{children:a.toLocaleDateString()})}},{id:"actions",cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:b=>{b.stopPropagation(),o(`/basic/especialidades/${a.id}`)},title:"Editar especialidad",children:e.jsx(U,{className:"h-4 w-4 text-blue-600"})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:b=>{b.stopPropagation(),l(a)},title:"Eliminar especialidad",children:e.jsx(W,{className:"h-4 w-4 text-red-600"})})]})}}],n=k({data:(i==null?void 0:i.results)||[],columns:y,getCoreRowModel:V(),getPaginationRowModel:R(),getSortedRowModel:F(),onSortingChange:g,state:{sorting:u},initialState:{pagination:{pageSize:10}}}),T=()=>{t&&(f.mutate(t.id),l(null))};return h?e.jsx("div",{className:"flex justify-center items-center p-8",children:"Cargando especialidades..."}):j?e.jsxs("div",{className:"text-center p-4 text-red-500",children:["Error al cargar especialidades: ",r.message]}):(v=i==null?void 0:i.results)!=null&&v.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(M,{children:[e.jsx(B,{children:n.getHeaderGroups().map(s=>e.jsx(N,{children:s.headers.map(a=>e.jsx(I,{children:a.isPlaceholder?null:C(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(H,{children:n.getRowModel().rows.map(s=>e.jsx(N,{className:"cursor-pointer hover:bg-blue-50",onClick:()=>o(`/basic/especialidades/${s.original.id}`),children:s.getVisibleCells().map(a=>e.jsx(q,{children:C(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",(i==null?void 0:i.count)||0," especialidades"]}),e.jsxs("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Página ",n.getState().pagination.pageIndex+1," de"," ",n.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"<"}),e.jsx(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:">"})]})]})]}),e.jsx(z,{open:!!t,onOpenChange:s=>!s&&l(null),children:e.jsxs(K,{children:[e.jsxs(L,{children:[e.jsx(A,{children:"Confirmar eliminación"}),e.jsxs($,{children:['¿Está seguro de que desea eliminar la especialidad "',t==null?void 0:t.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(_,{children:[e.jsx(c,{variant:"outline",onClick:()=>l(null),children:"Cancelar"}),e.jsx(c,{variant:"destructive",onClick:T,disabled:f.isPending,children:f.isPending?"Eliminando...":"Eliminar"})]})]})})]}):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"No se encontraron especialidades con los criterios especificados."})}function ve(){const x=w();E();const[m,o]=d.useState({}),{inputValue:p,setInputValue:t,debouncedValue:l}=J({initialValue:"",delay:500});d.useEffect(()=>{o(r=>({...r,search:l}))},[l]);const[u,g]=d.useState(0),i=r=>{t(r.target.value)},h=()=>{t(""),o({}),g(r=>r+1)},j=()=>{g(r=>r+1)};return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsx(Q,{icon:e.jsx(P,{size:40,strokeWidth:1.5}),title:"Especialidades Médicas",description:"Gestión de especialidades médicas relacionadas con los productos o servicios.",action:{label:"Agregar Especialidad",icon:e.jsx(se,{className:"h-4 w-4"}),onClick:()=>x("/basic/especialidades/add")}}),e.jsx(X,{title:"Filtros de Búsqueda",description:"Busca especialidades por nombre o código.",icon:e.jsx(ae,{className:"mr-2 h-5 w-5 text-blue-600"}),onClear:h,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Buscar"}),e.jsx(Y,{value:p,onChange:i,placeholder:"Buscar por nombre o código...",debouncedValue:l,inputProps:{id:"search"}})]})})}),e.jsx(Z,{className:"border-blue-100 shadow-md overflow-hidden",children:e.jsx(ee,{className:"p-0",children:e.jsx(ie,{filters:m,onDelete:j},u)})})]})}export{ve as default};
