import{s as b,p as C,q as D,r as z,j as e}from"./index-CuM1UVNz.js";import{c as E,a as w}from"./zonaService-BJYdhNdV.js";import{B as r}from"./button-DvvEsyKI.js";import{C as c,a as m,b as x,d as h,c as j,e as y}from"./card-D4d4qW_8.js";import{D as k,a as P,b as S,c as T,d as Z,e as L}from"./dialog-DY3vMJng.js";import{A as $}from"./arrow-left-EuUX28YT.js";import{M as p}from"./map-pin-DwgE0e9D.js";import{S as A}from"./square-pen-cdigAb40.js";import{T as M}from"./trash-2-BwIRBH_r.js";import{P as _}from"./plus-6cwyY5hA.js";import"./axios-CTonWHPK.js";import"./useInfiniteQuery-Ci5GnK52.js";import"./Combination-CQ9AiL49.js";function W(){var u;const{id:n}=b(),i=C(),{toast:t}=D(),[g,d]=z.useState(!1),{data:s,isLoading:f,isError:N,error:l}=E(n,{onError:a=>{t({title:"Error al cargar detalles",description:`No se pudieron cargar los detalles de la zona: ${a.message}`,variant:"destructive"})}}),o=w({onSuccess:()=>{t({title:"Zona eliminada",description:"La zona ha sido eliminada correctamente."}),i("/basic/zonas")},onError:a=>{t({title:"Error al eliminar",description:`No se pudo eliminar la zona: ${a.message}`,variant:"destructive"})}}),v=()=>{o.mutate(n,{onSettled:()=>{d(!1)}})};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs(r,{variant:"ghost",onClick:()=>i("/basic/zonas"),className:"mb-4",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Volver a zonas"]}),f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):N?e.jsxs(c,{className:"border-destructive",children:[e.jsxs(m,{children:[e.jsx(x,{children:"Error al cargar datos"}),e.jsx(h,{children:"No se pudieron cargar los detalles de la zona"})]}),e.jsx(j,{children:e.jsx("p",{children:(l==null?void 0:l.message)||"Error desconocido"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-6 w-6 mr-2 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:s.nombre})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(r,{variant:"outline",onClick:()=>i(`/basic/zonas/edit/${n}`),children:[e.jsx(A,{className:"mr-2 h-4 w-4"})," Editar"]}),e.jsxs(r,{variant:"destructive",onClick:()=>d(!0),children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," Eliminar"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(c,{className:"md:col-span-2",children:[e.jsxs(m,{children:[e.jsx(x,{children:"Detalles de la Zona"}),e.jsx(h,{children:"Información completa de la zona geográfica"})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Nombre"}),e.jsx("p",{className:"text-lg",children:s.nombre})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Código"}),e.jsx("p",{className:"text-lg font-mono",children:s.code})]})]}),s.cobertura&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Descripción de cobertura"}),e.jsx("p",{className:"text-base whitespace-pre-line",children:s.cobertura})]}),e.jsxs("div",{className:"border-t pt-4 mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Metadatos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ID: "}),e.jsx("span",{className:"font-mono",children:s.id})]}),s.created_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Creado: "}),e.jsx("span",{children:new Date(s.created_at).toLocaleString()})]}),s.updated_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Actualizado: "}),e.jsx("span",{children:new Date(s.updated_at).toLocaleString()})]})]})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(c,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex justify-between",children:[e.jsx("span",{children:"Ciudades"}),e.jsxs(r,{variant:"ghost",size:"sm",className:"h-8 gap-1",onClick:()=>i(`/basic/zonas/edit/${n}`),children:[e.jsx(_,{className:"h-4 w-4"})," Añadir"]})]}),e.jsx(h,{children:"Ciudades incluidas en esta zona"})]}),e.jsx(j,{children:s.ciudades&&s.ciudades.length>0?e.jsx("div",{className:"space-y-2",children:s.ciudades.map(a=>e.jsxs("div",{className:"flex items-center p-2 rounded-md border hover:bg-muted transition-colors",onClick:()=>i(`/basic/ciudades/${a.id}`),style:{cursor:"pointer"},children:[e.jsx(p,{className:"h-4 w-4 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.provincia})]})]},a.id))}):e.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No hay ciudades asignadas a esta zona"})}),e.jsx(y,{children:e.jsxs("div",{className:"text-xs text-muted-foreground w-full text-center",children:["Total: ",((u=s.ciudades)==null?void 0:u.length)||0," ciudades"]})})]})})]}),e.jsx(k,{open:g,onOpenChange:d,children:e.jsxs(P,{children:[e.jsxs(S,{children:[e.jsx(T,{children:"Confirmar eliminación"}),e.jsxs(Z,{children:['¿Estás seguro de que deseas eliminar la zona "',s.nombre,'"? Esta acción no se puede deshacer y también eliminará las relaciones con ciudades.']})]}),e.jsxs(L,{children:[e.jsx(r,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(r,{variant:"destructive",onClick:v,disabled:o.isPending,children:o.isPending?"Eliminando...":"Eliminar"})]})]})})]})]})}export{W as default};
