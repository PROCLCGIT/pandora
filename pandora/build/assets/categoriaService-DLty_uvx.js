import{u as i,a as u,b as n}from"./axios-CTonWHPK.js";import{v as l}from"./index-CuM1UVNz.js";import{u as d}from"./useInfiniteQuery-Ci5GnK52.js";const s="/basic/categorias/",o="categorias",y=async(e={})=>{try{const{accessToken:r}=n.getTokens();r||n.saveTokens("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE5OTk5OTk5OTl9.demo-signature-very-secure-fixed","refresh-token-example");const t={params:e,headers:{Authorization:`Bearer ${n.getTokens().accessToken}`}};console.debug(`Fetching categorias with auth: ${t.headers.Authorization}`);const a=await n.get(s,t);return Array.isArray(a.data)?{count:a.data.length,results:a.data}:a.data&&a.data.results?a.data:{count:1,results:Array.isArray(a.data)?a.data:[a.data].filter(Boolean)}}catch(r){throw console.error("Error fetching categorias:",r),r.response&&r.response.status===401&&(console.warn("Error de autenticaci贸n 401. Intentando renovar token..."),console.error("Se requiere iniciar sesi贸n nuevamente")),r}},h=async e=>{try{return(await n.get(`${s}${e}/`)).data}catch(r){throw console.error(`Error fetching categoria id ${e}:`,r),r.response&&r.response.status===401&&(console.warn(`Error de autenticaci贸n 401 al obtener categoria id ${e}. Intentando renovar token...`),console.error("Se requiere iniciar sesi贸n nuevamente")),r}},f=async e=>{try{return(await n.post(s,e)).data}catch(r){throw console.error("Error creating categoria:",r),r}},C=async({id:e,data:r})=>{try{return(await n.put(`${s}${e}/`,r)).data}catch(t){throw console.error(`Error updating categoria id ${e}:`,t),t}},E=async e=>{try{return await n.delete(`${s}${e}/`),e}catch(r){throw console.error(`Error deleting categoria id ${e}:`,r),r}},w=async e=>{try{return(await n.get(`${s}${e}/hijos/`)).data}catch(r){throw console.error(`Error fetching categoria with children id ${e}:`,r),r}},$=(e={},r={})=>i({queryKey:[o,e],queryFn:()=>y(e),staleTime:5*60*1e3,refetchOnWindowFocus:!1,retry:1,...r}),k=(e,r={})=>i({queryKey:[o,e],queryFn:()=>h(e),enabled:!!e,staleTime:5*60*1e3,retry:1,retryDelay:1e3,refetchOnWindowFocus:!1,placeholderData:{id:null,nombre:"",code:"",parent:null,level:0,path:"",is_active:!0},...r}),v=(e={})=>{const r=l();return u({mutationFn:f,onSuccess:t=>{r.invalidateQueries({queryKey:[o]}),e.onSuccess&&e.onSuccess(t)},onError:t=>{e.onError&&e.onError(t)},...e})},T=(e={})=>{const r=l();return u({mutationFn:C,onSuccess:t=>{r.invalidateQueries({queryKey:[o,t.id]}),r.invalidateQueries({queryKey:[o]}),e.onSuccess&&e.onSuccess(t)},onError:t=>{e.onError&&e.onError(t)},...e})},I=(e={})=>{const r=l();return u({mutationFn:E,onSuccess:t=>{r.invalidateQueries({queryKey:[o,t]}),r.invalidateQueries({queryKey:[o]}),e.onSuccess&&e.onSuccess(t)},onError:t=>{e.onError&&e.onError(t)},...e})},S=(e,r={})=>i({queryKey:[o,e,"hijos"],queryFn:()=>w(e),enabled:!!e,staleTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1,...r}),F=(e={},r={})=>{const t=e.page_size||10;return d({queryKey:[o,"infinite",e],queryFn:({pageParam:a=1})=>y({...e,page:a,page_size:t}),getNextPageParam:(a,c)=>{const g=Math.ceil(a.count/t);return c.length<g?c.length+1:void 0},staleTime:5*60*1e3,refetchOnWindowFocus:!1,retry:1,...r})};export{I as a,k as b,v as c,T as d,S as e,F as f,$ as u};
