import{p as w,q as P,r as d,j as e}from"./index-CuM1UVNz.js";import{u as F,f as v,g as k,a as R,b as V}from"./index-CzaDYwyb.js";import{B as c}from"./button-DvvEsyKI.js";import{T as M,a as B,b as N,c as I,d as H,e as q}from"./table-B6Cf0HfV.js";import{D as z,a as K,b as L,c as A,d as $,e as _}from"./dialog-DY3vMJng.js";import{c as G,d as O}from"./tipoContratacionService-BnsZCg0F.js";import{A as S}from"./arrow-up-down-Bkh7oTm8.js";import{F as T}from"./file-pen-line-BwjZ_lWF.js";import{S as U}from"./square-pen-cdigAb40.js";import{T as W}from"./trash-2-BwIRBH_r.js";import{u as J,P as Q,F as X,S as Y}from"./SearchInput-CDkOK910.js";import{C as Z,c as ee}from"./card-D4d4qW_8.js";import{P as ae}from"./plus-6cwyY5hA.js";import{F as se}from"./funnel-DTkdRWcb.js";import"./Combination-CQ9AiL49.js";import"./axios-CTonWHPK.js";import"./input-ZDudQbKj.js";function te({filters:x={},onDelete:m}){var b;const l=w(),{toast:p}=P(),[i,o]=d.useState(null),[u,g]=d.useState([]),{data:t,isLoading:h,isError:j,error:n,refetch:D}=G(x),f=O({onSuccess:a=>{p({title:"Tipo de contratación eliminado",description:"El tipo de contratación se ha eliminado correctamente."}),m&&m(a),D()},onError:a=>{p({title:"Error al eliminar",description:`No se pudo eliminar el tipo de contratación: ${a.message}`,variant:"destructive"})}}),y=[{accessorKey:"code",header:({column:a})=>e.jsxs(c,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),children:["Código",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>e.jsx("div",{className:"font-medium",children:a.getValue("code")})},{accessorKey:"nombre",header:({column:a})=>e.jsxs(c,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),children:["Nombre",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:a})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:a.getValue("nombre")})]})},{accessorKey:"created_at",header:"Fecha de Creación",cell:({row:a})=>{const s=new Date(a.original.created_at);return e.jsx("div",{children:s.toLocaleDateString()})}},{id:"actions",cell:({row:a})=>{const s=a.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),l(`/basic/tiposcontratacion/${s.id}`)},title:"Editar tipo de contratación",children:e.jsx(U,{className:"h-4 w-4 text-blue-600"})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),o(s)},title:"Eliminar tipo de contratación",children:e.jsx(W,{className:"h-4 w-4 text-red-600"})})]})}}],r=F({data:(t==null?void 0:t.results)||[],columns:y,getCoreRowModel:V(),getPaginationRowModel:R(),getSortedRowModel:k(),onSortingChange:g,state:{sorting:u},initialState:{pagination:{pageSize:10}}}),E=()=>{i&&(f.mutate(i.id),o(null))};return h?e.jsx("div",{className:"flex justify-center items-center p-8",children:"Cargando tipos de contratación..."}):j?e.jsxs("div",{className:"text-center p-4 text-red-500",children:["Error al cargar tipos de contratación: ",n.message]}):(b=t==null?void 0:t.results)!=null&&b.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(M,{children:[e.jsx(B,{children:r.getHeaderGroups().map(a=>e.jsx(N,{children:a.headers.map(s=>e.jsx(I,{children:s.isPlaceholder?null:v(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(H,{children:r.getRowModel().rows.map(a=>e.jsx(N,{className:"cursor-pointer hover:bg-blue-50",onClick:()=>l(`/basic/tiposcontratacion/${a.original.id}`),children:a.getVisibleCells().map(s=>e.jsx(q,{children:v(s.column.columnDef.cell,s.getContext())},s.id))},a.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",(t==null?void 0:t.count)||0," tipos de contratación"]}),e.jsxs("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Página ",r.getState().pagination.pageIndex+1," de"," ",r.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>r.previousPage(),disabled:!r.getCanPreviousPage(),children:"<"}),e.jsx(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>r.nextPage(),disabled:!r.getCanNextPage(),children:">"})]})]})]}),e.jsx(z,{open:!!i,onOpenChange:a=>!a&&o(null),children:e.jsxs(K,{children:[e.jsxs(L,{children:[e.jsx(A,{children:"Confirmar eliminación"}),e.jsxs($,{children:['¿Está seguro de que desea eliminar el tipo de contratación "',i==null?void 0:i.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(_,{children:[e.jsx(c,{variant:"outline",onClick:()=>o(null),children:"Cancelar"}),e.jsx(c,{variant:"destructive",onClick:E,disabled:f.isPending,children:f.isPending?"Eliminando...":"Eliminar"})]})]})})]}):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"No se encontraron tipos de contratación con los criterios especificados."})}function ve(){const x=w();P();const[m,l]=d.useState({}),{inputValue:p,setInputValue:i,debouncedValue:o}=J({initialValue:"",delay:500});d.useEffect(()=>{l(n=>({...n,search:o}))},[o]);const[u,g]=d.useState(0),t=n=>{i(n.target.value)},h=()=>{i(""),l({}),g(n=>n+1)},j=()=>{g(n=>n+1)};return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsx(Q,{icon:e.jsx(T,{size:40,strokeWidth:1.5}),title:"Tipos de Contratación",description:"Gestión de los diferentes tipos de contratación de servicios o compra de productos.",action:{label:"Agregar Tipo de Contratación",icon:e.jsx(ae,{className:"h-4 w-4"}),onClick:()=>x("/basic/tiposcontratacion/add")}}),e.jsx(X,{title:"Filtros de Búsqueda",description:"Busca tipos de contratación por nombre o código.",icon:e.jsx(se,{className:"mr-2 h-5 w-5 text-blue-600"}),onClear:h,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Buscar"}),e.jsx(Y,{value:p,onChange:t,placeholder:"Buscar por nombre o código...",debouncedValue:o,inputProps:{id:"search"}})]})})}),e.jsx(Z,{className:"border-blue-100 shadow-md overflow-hidden",children:e.jsx(ee,{className:"p-0",children:e.jsx(te,{filters:m,onDelete:j},u)})})]})}export{ve as default};
