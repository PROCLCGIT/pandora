import{p as z,q as O,r as i,j as e}from"./index-CuM1UVNz.js";import{u as G,a as L}from"./marcaService-DsNCAPSw.js";import{u as H,P as R,F as W,S as J}from"./SearchInput-CDkOK910.js";import{B as g}from"./badge-D5I9DsW8.js";import{B as b}from"./button-DvvEsyKI.js";import{D as K,a as Q,b as U,c as X,d as Y,e as Z}from"./dialog-DY3vMJng.js";import{S,a as C,b as y,c as D,d as o}from"./select-BYbUwerd.js";import{D as ee,A as se}from"./ActionButtons-CaN9juX7.js";import{P as ae}from"./plus-6cwyY5hA.js";import{A as E}from"./award-Bv_wBtov.js";import{F as re}from"./funnel-DTkdRWcb.js";import{G as ie}from"./globe-FYGSDlcS.js";import"./axios-CTonWHPK.js";import"./useInfiniteQuery-Ci5GnK52.js";import"./card-D4d4qW_8.js";import"./input-ZDudQbKj.js";import"./Combination-CQ9AiL49.js";import"./index-BmPRlYq_.js";import"./index-CkfEdLBp.js";import"./index-BGi3wog7.js";import"./table-B6Cf0HfV.js";import"./tooltip-MLxQ3M63.js";import"./eye-DnbWXCAI.js";import"./file-pen-CTd16QCS.js";import"./trash-2-BwIRBH_r.js";function _e(){const l=z(),{toast:m}=O(),[t,n]=i.useState({is_active:void 0,country_origin:void 0}),[w,c]=i.useState(!1),[r,f]=i.useState(null),[j,u]=i.useState(1),h=10,{inputValue:P,setInputValue:v,debouncedValue:d}=H({initialValue:"",delay:500});i.useEffect(()=>{u(1),n(s=>({...s,search:d}))},[d]),i.useEffect(()=>{Object.entries(t).some(([I,$])=>I!=="search"&&$!==void 0)&&u(1)},[t]);const{data:a,isLoading:V,isError:_,error:x,refetch:N}=G({...t,search:d,page:j,page_size:h},{keepPreviousData:!0,onError:s=>{m({title:"Error al cargar datos",description:`No se pudieron cargar las marcas: ${s.message}`,variant:"destructive"})}}),p=L({onSuccess:()=>{m({title:"Marca eliminada",description:r?`La marca "${r.nombre}" ha sido eliminada correctamente.`:"La marca ha sido eliminada correctamente."})},onError:s=>{m({title:"Error al eliminar",description:`No se pudo eliminar la marca: ${s.message}`,variant:"destructive"})}}),A=s=>{v(s.target.value)},F=s=>{n({...t,is_active:s==="all"?void 0:s==="true"})},M=s=>{n({...t,country_origin:s==="all"?void 0:s})},k=s=>{f(s),c(!0)},B=()=>{p.mutate(r.id,{onSettled:()=>{c(!1),f(null),N()}})},T=a!=null&&a.results?Array.from(new Set(a.results.filter(s=>s.country_origin).map(s=>s.country_origin))).sort():[],q=[{header:"Nombre",accessor:"nombre",cell:s=>e.jsxs("div",{className:"font-medium flex items-center text-gray-800",children:[e.jsx(E,{className:"h-4 w-4 mr-2 text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"truncate",title:s.nombre,children:s.nombre})]})},{header:"Código",accessor:"code",cell:s=>e.jsx(g,{variant:"outline",className:"font-mono bg-blue-50 text-blue-800 border-blue-200",children:s.code||"N/A"})},{header:"País",accessor:"country_origin",cell:s=>e.jsx("span",{className:"text-gray-700",children:s.country_origin||"—"})},{header:"Sitio web",accessor:"website",cell:s=>s.website?e.jsxs("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:underline",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),s.website.replace(/^https?:\/\//,"")]}):e.jsx("span",{className:"text-muted-foreground text-sm italic",children:"Sin sitio web"})},{header:"Estado",accessor:"is_active",cell:s=>s.is_active?e.jsx(g,{className:"bg-green-500 hover:bg-green-600",children:"Activo"}):e.jsx(g,{variant:"secondary",children:"Inactivo"})},{header:"Acciones",accessor:"id",style:{textAlign:"center",width:"7rem"},cell:s=>e.jsx(se,{onView:()=>l(`/basic/marcas/${s.id}`),onEdit:()=>l(`/basic/marcas/edit/${s.id}`),onDelete:()=>k(s)})}];return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsx(R,{icon:e.jsx(E,{size:40,strokeWidth:1.5}),title:"Gestión de Marcas",description:"Administra las marcas de productos y equipos médicos.",action:{label:"Agregar Marca",icon:e.jsx(ae,{className:"h-4 w-4"}),onClick:()=>l("/basic/marcas/add")}}),e.jsx(W,{title:"Filtros de Búsqueda",description:"Busca marcas por nombre, código, país o estado.",icon:e.jsx(re,{className:"mr-2 h-5 w-5 text-blue-600"}),onClear:()=>{v(""),n({is_active:void 0,country_origin:void 0})},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Buscar"}),e.jsx(J,{value:P,onChange:A,placeholder:"Buscar por nombre o código...",debouncedValue:d,inputProps:{id:"search"}})]}),e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:"Estado"}),e.jsxs(S,{onValueChange:F,defaultValue:"all",children:[e.jsx(C,{id:"status",className:"h-9 border-blue-200 focus:border-blue-400",children:e.jsx(y,{placeholder:"Todos los estados"})}),e.jsxs(D,{children:[e.jsx(o,{value:"all",children:"Todos"}),e.jsx(o,{value:"true",children:"Activo"}),e.jsx(o,{value:"false",children:"Inactivo"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"country",className:"text-sm font-medium",children:"País de origen"}),e.jsxs(S,{onValueChange:M,defaultValue:"all",children:[e.jsx(C,{id:"country",className:"h-9 border-blue-200 focus:border-blue-400",children:e.jsx(y,{placeholder:"Todos los países"})}),e.jsxs(D,{children:[e.jsx(o,{value:"all",children:"Todos"}),T.map(s=>e.jsx(o,{value:s,children:s},s))]})]})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsx(b,{variant:"outline",size:"sm",onClick:()=>l("/basic/marcas/infinite"),className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:"Ver con paginación infinita"})}),e.jsx(ee,{columns:q,data:a==null?void 0:a.results,isLoading:V,isError:_,errorMessage:x==null?void 0:x.message,onRetry:N,emptyMessage:"No se encontraron marcas que coincidan con la búsqueda.",pagination:{currentPage:j,totalPages:Math.ceil(((a==null?void 0:a.count)||0)/h),totalItems:(a==null?void 0:a.count)||0,pageSize:h,onPageChange:u}}),e.jsx(K,{open:w,onOpenChange:c,children:e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(X,{children:"Confirmar eliminación"}),e.jsxs(Y,{children:['¿Estás seguro de que deseas eliminar la marca "',r==null?void 0:r.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(Z,{children:[e.jsx(b,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(b,{variant:"destructive",onClick:B,disabled:p.isPending,children:p.isPending?"Eliminando...":"Eliminar"})]})]})})]})}export{_e as default};
