import{s as N,p as L,q as P,r as z,j as e,B as q}from"./index-CuM1UVNz.js";import{u as B,F as I,a as t,b as n,c as l,d as u,e as m,f as p}from"./form-v5aSno6F.js";import{o as $,c as k,d as x}from"./index.esm-mctYN2X9.js";import{b as y,c as M,d as U}from"./ciudadService-DirJXudY.js";import{I as b}from"./input-ZDudQbKj.js";import{F as A}from"./FormCard-dpmmvjug.js";import"./axios-CTonWHPK.js";import"./useInfiniteQuery-Ci5GnK52.js";import"./button-DvvEsyKI.js";import"./card-D4d4qW_8.js";import"./arrow-left-EuUX28YT.js";const D=k({nombre:x().required("El nombre es obligatorio").max(50,"El nombre no debe exceder los 50 caracteres"),provincia:x().required("La provincia es obligatoria").max(50,"La provincia no debe exceder los 50 caracteres"),code:x().required("El código es obligatorio").max(50,"El código no debe exceder los 50 caracteres")});function Y(){const{id:d}=N(),c=L(),{toast:o}=P(),i=!!d,a=B({resolver:$(D),defaultValues:{nombre:"",provincia:"",code:""}}),{data:s,isLoading:V}=y(d);z.useEffect(()=>{i&&s&&a.reset({nombre:s.nombre,provincia:s.provincia,code:s.code})},[s,a,i]);const j=M(),g=U(),v=()=>{o({title:"Ciudad creada",description:"La ciudad ha sido creada exitosamente."}),c("/basic/ciudades")},f=r=>{o({title:"Error al crear",description:`No se pudo crear la ciudad: ${r.message||"Error desconocido"}`,variant:"destructive"})},C=()=>{o({title:"Ciudad actualizada",description:"La ciudad ha sido actualizada exitosamente."}),c("/basic/ciudades")},E=r=>{o({title:"Error al actualizar",description:`No se pudo actualizar la ciudad: ${r.message||"Error desconocido"}`,variant:"destructive"})},h=r=>{try{i?g.mutate({id:d,data:r},{onSuccess:C,onError:E}):j.mutate(r,{onSuccess:v,onError:f})}catch(S){console.error("Error en formulario:",S),o({title:"Error en el formulario",description:"Hubo un error al procesar el formulario. Por favor, revisa los datos ingresados.",variant:"destructive"})}},F=j.isPending||g.isPending;return e.jsx(A,{title:i?"Editar Ciudad":"Nueva Ciudad",description:i?"Actualiza la información de la ciudad existente":"Completa el formulario para crear una nueva ciudad",onSubmit:a.handleSubmit(h),onCancel:()=>c("/basic/ciudades"),backLink:"Volver a ciudades",isSubmitting:F,icon:e.jsx(q,{size:24,strokeWidth:1.5}),children:e.jsx(I,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(h),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(t,{control:a.control,name:"nombre",render:({field:r})=>e.jsxs(n,{children:[e.jsx(l,{children:"Nombre"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Nombre de la ciudad",...r})}),e.jsx(m,{children:"Nombre completo de la ciudad"}),e.jsx(p,{})]})}),e.jsx(t,{control:a.control,name:"provincia",render:({field:r})=>e.jsxs(n,{children:[e.jsx(l,{children:"Provincia"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Provincia",...r})}),e.jsx(m,{children:"Provincia a la que pertenece la ciudad"}),e.jsx(p,{})]})})]}),e.jsx(t,{control:a.control,name:"code",render:({field:r})=>e.jsxs(n,{children:[e.jsx(l,{children:"Código"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Código",...r})}),e.jsx(m,{children:"Código único para identificar la ciudad"}),e.jsx(p,{})]})})]})})})}export{Y as default};
