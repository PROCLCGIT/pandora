import{p as w,q as T,r as d,j as e}from"./index-CuM1UVNz.js";import{u as k,f as v,g as F,a as R,b as V}from"./index-CzaDYwyb.js";import{B as l}from"./button-DvvEsyKI.js";import{T as M,a as B,b as N,c as I,d as H,e as q}from"./table-B6Cf0HfV.js";import{D as z,a as K,b as A,c as L,d as U,e as $}from"./dialog-DY3vMJng.js";import{c as _,d as G}from"./tipoClienteService-sNnJhpCJ.js";import{A as S}from"./arrow-up-down-Bkh7oTm8.js";import{U as P}from"./users-pPiCKQq6.js";import{S as O}from"./square-pen-cdigAb40.js";import{T as W}from"./trash-2-BwIRBH_r.js";import{u as J,P as Q,F as X,S as Y}from"./SearchInput-CDkOK910.js";import{C as Z,c as ee}from"./card-D4d4qW_8.js";import{P as se}from"./plus-6cwyY5hA.js";import{F as ie}from"./funnel-DTkdRWcb.js";import"./Combination-CQ9AiL49.js";import"./axios-CTonWHPK.js";import"./input-ZDudQbKj.js";function te({filters:x={},onDelete:m}){var b;const c=w(),{toast:p}=T(),[a,r]=d.useState(null),[u,g]=d.useState([]),{data:t,isLoading:h,isError:j,error:n,refetch:D}=_(x),f=G({onSuccess:s=>{p({title:"Tipo de cliente eliminado",description:"El tipo de cliente se ha eliminado correctamente."}),m&&m(s),D()},onError:s=>{p({title:"Error al eliminar",description:`No se pudo eliminar el tipo de cliente: ${s.message}`,variant:"destructive"})}}),y=[{accessorKey:"code",header:({column:s})=>e.jsxs(l,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Código",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("code")})},{accessorKey:"nombre",header:({column:s})=>e.jsxs(l,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:s.getValue("nombre")})]})},{accessorKey:"created_at",header:"Fecha de Creación",cell:({row:s})=>{const i=new Date(s.original.created_at);return e.jsx("div",{children:i.toLocaleDateString()})}},{id:"actions",cell:({row:s})=>{const i=s.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),c(`/basic/tiposcliente/${i.id}`)},title:"Editar tipo de cliente",children:e.jsx(O,{className:"h-4 w-4 text-blue-600"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),r(i)},title:"Eliminar tipo de cliente",children:e.jsx(W,{className:"h-4 w-4 text-red-600"})})]})}}],o=k({data:(t==null?void 0:t.results)||[],columns:y,getCoreRowModel:V(),getPaginationRowModel:R(),getSortedRowModel:F(),onSortingChange:g,state:{sorting:u},initialState:{pagination:{pageSize:10}}}),E=()=>{a&&(f.mutate(a.id),r(null))};return h?e.jsx("div",{className:"flex justify-center items-center p-8",children:"Cargando tipos de cliente..."}):j?e.jsxs("div",{className:"text-center p-4 text-red-500",children:["Error al cargar tipos de cliente: ",n.message]}):(b=t==null?void 0:t.results)!=null&&b.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(M,{children:[e.jsx(B,{children:o.getHeaderGroups().map(s=>e.jsx(N,{children:s.headers.map(i=>e.jsx(I,{children:i.isPlaceholder?null:v(i.column.columnDef.header,i.getContext())},i.id))},s.id))}),e.jsx(H,{children:o.getRowModel().rows.map(s=>e.jsx(N,{className:"cursor-pointer hover:bg-blue-50",onClick:()=>c(`/basic/tiposcliente/${s.original.id}`),children:s.getVisibleCells().map(i=>e.jsx(q,{children:v(i.column.columnDef.cell,i.getContext())},i.id))},s.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",(t==null?void 0:t.count)||0," tipos de cliente"]}),e.jsxs("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Página ",o.getState().pagination.pageIndex+1," de"," ",o.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>o.previousPage(),disabled:!o.getCanPreviousPage(),children:"<"}),e.jsx(l,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>o.nextPage(),disabled:!o.getCanNextPage(),children:">"})]})]})]}),e.jsx(z,{open:!!a,onOpenChange:s=>!s&&r(null),children:e.jsxs(K,{children:[e.jsxs(A,{children:[e.jsx(L,{children:"Confirmar eliminación"}),e.jsxs(U,{children:['¿Está seguro de que desea eliminar el tipo de cliente "',a==null?void 0:a.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs($,{children:[e.jsx(l,{variant:"outline",onClick:()=>r(null),children:"Cancelar"}),e.jsx(l,{variant:"destructive",onClick:E,disabled:f.isPending,children:f.isPending?"Eliminando...":"Eliminar"})]})]})})]}):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"No se encontraron tipos de cliente con los criterios especificados."})}function ve(){const x=w();T();const[m,c]=d.useState({}),{inputValue:p,setInputValue:a,debouncedValue:r}=J({initialValue:"",delay:500});d.useEffect(()=>{c(n=>({...n,search:r}))},[r]);const[u,g]=d.useState(0),t=n=>{a(n.target.value)},h=()=>{a(""),c({}),g(n=>n+1)},j=()=>{g(n=>n+1)};return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsx(Q,{icon:e.jsx(P,{size:40,strokeWidth:1.5}),title:"Tipos de Cliente",description:"Gestión de clasificaciones para diferentes tipos de clientes.",action:{label:"Agregar Tipo de Cliente",icon:e.jsx(se,{className:"h-4 w-4"}),onClick:()=>x("/basic/tiposcliente/add")}}),e.jsx(X,{title:"Filtros de Búsqueda",description:"Busca tipos de cliente por nombre o código.",icon:e.jsx(ie,{className:"mr-2 h-5 w-5 text-blue-600"}),onClear:h,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Buscar"}),e.jsx(Y,{value:p,onChange:t,placeholder:"Buscar por nombre o código...",debouncedValue:r,inputProps:{id:"search"}})]})})}),e.jsx(Z,{className:"border-blue-100 shadow-md overflow-hidden",children:e.jsx(ee,{className:"p-0",children:e.jsx(te,{filters:m,onDelete:j},u)})})]})}export{ve as default};
