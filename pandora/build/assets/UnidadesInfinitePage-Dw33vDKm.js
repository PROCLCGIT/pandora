import{p as w,q as P,r as c,j as e}from"./index-CuM1UVNz.js";import{u as T,f as C,g as k,a as F,b as U}from"./index-CzaDYwyb.js";import{B as o}from"./button-DvvEsyKI.js";import{T as V,a as M,b as N,c as B,d as I,e as H}from"./table-B6Cf0HfV.js";import{D as q,a as z,b as K,c as L,d as A,e as $}from"./dialog-DY3vMJng.js";import{c as _,d as G,R as D}from"./unidadService-Bs8V2DCy.js";import{A as S}from"./arrow-up-down-Bkh7oTm8.js";import{S as O}from"./square-pen-cdigAb40.js";import{T as W}from"./trash-2-BwIRBH_r.js";import{u as J,P as Q,F as X,S as Y}from"./SearchInput-CDkOK910.js";import{C as Z,c as ee}from"./card-D4d4qW_8.js";import{P as se}from"./plus-6cwyY5hA.js";import{F as ae}from"./funnel-DTkdRWcb.js";import"./Combination-CQ9AiL49.js";import"./axios-CTonWHPK.js";import"./input-ZDudQbKj.js";function ie({filters:x={},onDelete:m}){var v;const d=w(),{toast:u}=P(),[t,r]=c.useState(null),[h,g]=c.useState([]),{data:i,isLoading:p,isError:j,error:n,refetch:y}=_(x),f=G({onSuccess:s=>{u({title:"Unidad eliminada",description:"La unidad se ha eliminado correctamente."}),m&&m(s),y()},onError:s=>{u({title:"Error al eliminar",description:`No se pudo eliminar la unidad: ${s.message}`,variant:"destructive"})}}),E=[{accessorKey:"code",header:({column:s})=>e.jsxs(o,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Código",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("code")})},{accessorKey:"nombre",header:({column:s})=>e.jsxs(o,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:s.getValue("nombre")})]})},{accessorKey:"created_at",header:"Fecha de Creación",cell:({row:s})=>{const a=new Date(s.original.created_at);return e.jsx("div",{children:a.toLocaleDateString()})}},{id:"actions",cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:b=>{b.stopPropagation(),d(`/basic/unidades/${a.id}`)},title:"Editar unidad",children:e.jsx(O,{className:"h-4 w-4 text-blue-600"})}),e.jsx(o,{variant:"ghost",size:"icon",onClick:b=>{b.stopPropagation(),r(a)},title:"Eliminar unidad",children:e.jsx(W,{className:"h-4 w-4 text-red-600"})})]})}}],l=T({data:(i==null?void 0:i.results)||[],columns:E,getCoreRowModel:U(),getPaginationRowModel:F(),getSortedRowModel:k(),onSortingChange:g,state:{sorting:h},initialState:{pagination:{pageSize:10}}}),R=()=>{t&&(f.mutate(t.id),r(null))};return p?e.jsx("div",{className:"flex justify-center items-center p-8",children:"Cargando unidades..."}):j?e.jsxs("div",{className:"text-center p-4 text-red-500",children:["Error al cargar unidades: ",n.message]}):(v=i==null?void 0:i.results)!=null&&v.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(V,{children:[e.jsx(M,{children:l.getHeaderGroups().map(s=>e.jsx(N,{children:s.headers.map(a=>e.jsx(B,{children:a.isPlaceholder?null:C(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(I,{children:l.getRowModel().rows.map(s=>e.jsx(N,{className:"cursor-pointer hover:bg-blue-50",onClick:()=>d(`/basic/unidades/${s.original.id}`),children:s.getVisibleCells().map(a=>e.jsx(H,{children:C(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",(i==null?void 0:i.count)||0," unidades"]}),e.jsxs("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Página ",l.getState().pagination.pageIndex+1," de"," ",l.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"<"}),e.jsx(o,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:">"})]})]})]}),e.jsx(q,{open:!!t,onOpenChange:s=>!s&&r(null),children:e.jsxs(z,{children:[e.jsxs(K,{children:[e.jsx(L,{children:"Confirmar eliminación"}),e.jsxs(A,{children:['¿Está seguro de que desea eliminar la unidad "',t==null?void 0:t.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs($,{children:[e.jsx(o,{variant:"outline",onClick:()=>r(null),children:"Cancelar"}),e.jsx(o,{variant:"destructive",onClick:R,disabled:f.isPending,children:f.isPending?"Eliminando...":"Eliminar"})]})]})})]}):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"No se encontraron unidades con los criterios especificados."})}function ve(){const x=w();P();const[m,d]=c.useState({}),{inputValue:u,setInputValue:t,debouncedValue:r}=J({initialValue:"",delay:500});c.useEffect(()=>{d(n=>({...n,search:r}))},[r]);const[h,g]=c.useState(0),i=n=>{t(n.target.value)},p=()=>{t(""),d({}),g(n=>n+1)},j=()=>{g(n=>n+1)};return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsx(Q,{icon:e.jsx(D,{size:40,strokeWidth:1.5}),title:"Unidades de Medida",description:"Gestión de unidades de medida para los productos.",action:{label:"Agregar Unidad",icon:e.jsx(se,{className:"h-4 w-4"}),onClick:()=>x("/basic/unidades/add")}}),e.jsx(X,{title:"Filtros de Búsqueda",description:"Busca unidades por nombre o código.",icon:e.jsx(ae,{className:"mr-2 h-5 w-5 text-blue-600"}),onClear:p,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Buscar"}),e.jsx(Y,{value:u,onChange:i,placeholder:"Buscar por nombre o código...",debouncedValue:r,inputProps:{id:"search"}})]})})}),e.jsx(Z,{className:"border-blue-100 shadow-md overflow-hidden",children:e.jsx(ee,{className:"p-0",children:e.jsx(ie,{filters:m,onDelete:j},h)})})]})}export{ve as default};
